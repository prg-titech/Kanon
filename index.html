<!doctype html>
<html>
    <head>
    	<title>Kanon</title>

    	<link href="node_modules/vis/dist/vis.css" rel="stylesheet" type="text/css"/>
    	<link href="node_modules/jquery-ui-dist/jquery-ui.css" rel="stylesheet" type="text/css"/>
		<link rel="stylesheet" href="external/prototype_window/themes/default.css"/>
		<link rel="stylesheet" href="external/prototype_window/themes/mac_os_x.css"/>
    	<link rel="stylesheet" href="node_modules/split-pane/split-pane.css"/>
    	<link rel="stylesheet" href="node_modules/split-pane/pretty-split-pane.css"/>
    	<link rel="stylesheet" type="text/css" href="src/css/style.css">
    	<link rel="stylesheet" type="text/css" href="src/css/call-tree-network.css">
		<link rel="stylesheet" type="text/css" href="src/css/tooltip.css">

		<script type="text/javascript" src="src/import.js"></script>

		<style type="text/css">
			html, body {
				height: 100%;
				min-height: 100%;
				margin: 0;
				padding: 0;
                overflow: hidden;
			}
		</style>
		<link rel="stylesheet" type="text/css" href="src/css/split-pane.css">

		<script>
            jQuery(function() {
                jQuery('div.split-pane').splitPane();
            });
            __$__.d3 = d3;
    	</script>
    </head>
<body>

	<div id="menu-bar">
        <div id="viewMode">
			View Mode:
        	<select name="pullDownViewMode" id="pullDownViewMode">
				<option value="Snapshot">Snapshot</option>
				<option value="Summarized">Summarized</option>
			</select>
		</div>
		<form id='fontSizeForm' name='fontSizeForm'>
			font size: <input id="fontSize" name="fontSize" oninput="__$__.FontSizeUpdate();" placeholder="12">
		</form>
		<div id="autoLayout">
			<input type="checkbox" name="autoLayout" value="true" checked="checked">Auto Layout
		</div>
        <div id="fileOperation">
			<input id="saveButton" type="button" value="Save file"
				   onclick="__$__.saveFile()">
			<input type="file" id="readInput"
				   onclick="__$__.readFile()">
		</div>
		<input id="redrawButton" type="button" value="redraw"
			   onclick="__$__.Update.waitForStabilized = false; __$__.Update.ContextUpdate('changed');">
	</div>
	<div class="pretty-split-pane-frame" id="split-pane-frame">
		<div class="split-pane fixed-left" id="split-pane">
			<div class="split-pane-component" id="left-component">
				<div class="pretty-split-pane-component-inner">
					<div id="editor">
						<script type="text/javascript" src="src/js/editor.js"></script>
					</div>
				</div>
			</div>
			<div class="split-pane-divider" id="vertical-divider"></div>
			<div class="split-pane-component" id="right-component">
				<div class="split-pane horizontal-percent">
					<div class="split-pane-component" id="top-component">
						<div class="pretty-split-pane-component-inner">
							<div id="mynetwork"></div>
						</div>
					</div>
					<div class="split-pane-divider" id="horizontal-divider"></div>
					<div class="split-pane-component" id="bottom-component">
						<div class="pretty-split-pane-component-inner">
							<div id="callTree"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id='console'></div>
	<div id="network-popUp">
		<span id="operation">node</span> <br>
		<table style="margin:auto;">
			<tr>
				<td>label</td>
				<td><input id="node-label" value="new value" /></td>
			</tr>
		</table>
		<div id="isLiteral">
			<input type="checkbox" name="isLiteral" id="checkboxForLiteral" value="true">Literal
		</div>
		<input type="button" value="save" id="saveButtonForTestize" />
		<input type="button" value="cancel" id="cancelButtonForTestize" />
	</div>
    <div id="tooltip_1" class="seecoderun_tooltip">set test</div>
	<div id="tooltip_2" class="seecoderun_tooltip">remove test</div>

	<script type="text/javascript" src="src/js/network.js"></script>
	<script type="text/javascript" src="src/js/call-tree-network.js"></script>
	<script>
		jQuery.noConflict();
        __$__.StorePositions.registerPositions();
        __$__.StorePositions.oldNetwork.edges = __$__.ObjectGraphNetwork.edges._data;

        __$__.editor.getSelection().clearSelection();
        __$__.Update.PositionUpdate();

        jQuery(window).on('resize' ,function() {
            if (__$__.CallTreeNetwork.whileDrawing !== true) {
                __$__.ObjectGraphNetwork.network.redraw();
                __$__.CallTreeNetwork.redraw();
            }
        });
        document.getElementById('pullDownViewMode').onchange = function() {
            let selectedValue = document.getElementById('pullDownViewMode').value;
			__$__.Context.SwitchViewMode(selectedValue === 'Snapshot');
			__$__.Update.ContextUpdate('changed');
		};
		document.getElementById('autoLayout').onchange = function() {
            __$__.Layout.switchEnabled();
		};
		(() => {
		    var isDragging = false;
            jQuery('div.split-pane')
				.mousedown(function () {
                    isDragging = true;
                })
				.mousemove(function () {
				    if (isDragging) {
                        __$__.ObjectGraphNetwork.network.redraw();
                        __$__.CallTreeNetwork.redraw();
					}
				})
				.mouseup(() => {
				    isDragging = false;
				});
        })();

		__$__.Testize.popup_addTest = document.getElementById('tooltip_1');
        __$__.Testize.popup_addTest.onclick = function(e) {
            __$__.Testize.selectedCallInfo = {
                label: __$__.Testize.hoveringCallInfo.label
            };
            __$__.Testize.openWin();
            __$__.Testize.removeTooltip(this);
        };
        __$__.Testize.popup_addTest.onmouseover = function(e) {
            __$__.Testize.popup_addTest.style.cursor = 'pointer';
        };
        __$__.Testize.popup_addTest.onmouseout = function(e) {
            __$__.Testize.popup_addTest.style.cursor = 'default';
        };
        __$__.Testize.popup_removeTest = document.getElementById('tooltip_2');
        __$__.Testize.popup_removeTest.onclick = function(e) {
            __$__.Testize.removeTest(__$__.Testize.hoveringCallInfo.label);
            __$__.Testize.removeTooltip(this);
        };
        __$__.Testize.popup_removeTest.onmouseover = function(e) {
            __$__.Testize.popup_removeTest.style.cursor = 'pointer';
        };
        __$__.Testize.popup_removeTest.onmouseout = function(e) {
            __$__.Testize.popup_removeTest.style.cursor = 'default';
        };
        jQuery("#node-label").keyup(function(event) {
            if (event.keyCode === 13) {
                jQuery("#saveButtonForTestize").click();
            }
        });
	</script>
</body>
</html>
