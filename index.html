<!doctype html>
<html>
<head>
	<title>Kanon</title>

	<script type="text/javascript" src="src/js/setup.js"></script>
	<script type="text/javascript" src="node_modules/vis/dist/vis.js"></script>
	<script type="text/javascript" src="node_modules/ace-builds/src/ace.js"></script>
	<script type="text/javascript" src="node_modules/ace-builds/src/ext-language_tools.js"></script>
	<script type="text/javascript" src="node_modules/esprima/dist/esprima.js"></script>
	<script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript" src="node_modules/jquery-ui-dist/jquery-ui.js"></script>
	<script type="text/javascript" src="external/escodegen/escodegen.browser.js"></script>
	<link href="node_modules/vis/dist/vis.css" rel="stylesheet" type="text/css"/>
	<link href="node_modules/jquery-ui-dist/jquery-ui.css" rel="stylesheet" type="text/css"/>
	<link rel="stylesheet" type="text/css" href="src/css/style.css">
</head>
<body>

<script type="text/javascript" src="src/js/animation.js"></script>
<script type="text/javascript" src="src/js/toVisjs.js"></script>
<script type="text/javascript" src="src/js/traverse.js"></script>
<script type="text/javascript" src="src/js/store-positions.js"></script>
<script type="text/javascript" src="src/js/code-conversion.js"></script>
<script type="text/javascript" src="src/js/update.js"></script>
<script type="text/javascript" src="src/js/context.js"></script>
<script type="text/javascript" src="src/js/jump-to-const.js"></script>
<script type="text/javascript" src="src/js/layout.js"></script>
<script type="text/javascript" src="src/js/probe.js"></script>
<script type="text/javascript" src="src/js/manipulate.js"></script>
<script type="text/javascript" src="src/js/readFile.js"></script>
<script type="text/javascript" src="src/js/saveFile.js"></script>
<script type="text/javascript" src="src/js/call-tree.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-walker.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-builder.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-transforms.js"></script>

<div id="editor_wrapper">
	<div id="editor">
		<script type="text/javascript" src="src/js/editor.js"></script>
	</div>
	<div id="show_context"></div>
</div>

<div id="saveInput">
	<input id="saveButton" type="button" value="Save file" onclick="__$__.saveFile()">
</div>

<div id="readInput">
	<input type="file" id="readFile" onclick="__$__.readFile()"/>
</div>


<div id="resizableNetwork">
	<div id="mynetwork"></div>
	<input id="resetButton" type="button" value="Redraw"
		   onclick="__$__.Update.waitForStabilized = false; __$__.Update.ContextUpdate('changed');">
</div>

<div id="callTreeDiagram" oncontextmenu="return false;">
    <div id="callTree"></div>
</div>

<div id='viewmodebutton'>
	<input type="button" value="Summarized"
		   onclick="__$__.Context.SwitchViewMode(false); __$__.Update.ContextUpdate('changed');">
	<input type="button" value="Snapshot"
		   onclick="__$__.Context.SwitchViewMode(true); __$__.Update.ContextUpdate('changed');">
</div>

<div id='viewmode'></div>

<form id='fontSizeForm' name='fontSizeForm'>
	font size:
	<input id="fontSize" name="fontSize" oninput="__$__.FontSizeUpdate();" placeholder="12">
</form>

<div id='BackButton'>
	<input type="button" value="< back"
		   onclick="if (__$__.Context.MoveContextOnCursorPosition(-1)) __$__.Context.Draw();">
</div>

<div id='ForwardButton'>
	<input type="button" value="forward >"
		   onclick="if (__$__.Context.MoveContextOnCursorPosition(1)) __$__.Context.Draw();">
</div>

<div id='autoLayoutButton'>
	<input type="button" value="Auto Layout" onclick="__$__.Layout.switchEnabled();">
</div>

<div id='autoLayout'>ON</div>

<div id='callTreeNetwork'>
	<input type="button" value="call tree" onclick="__$__.CallTreeNetwork.switchEnabled();">
</div>

<div id='console'></div>

<script type="text/javascript" src="src/js/network.js"></script>
<script type="text/javascript" src="src/js/call-tree-network.js"></script>
<script>
    __$__.StorePositions.registerPositions();
    __$__.StorePositions.oldNetwork.edges = __$__.edges._data;

    __$__.Update.PositionUpdate();
    __$__.editor.getSelection().clearSelection();

    document.getElementById('viewmode').textContent = (__$__.Context.Snapshot) ? 'View Mode: Snapshot' : 'View Mode: Summarized';

    window.onresize = function() {
        __$__.network.redraw();
    };
	$("#editor_wrapper").resizable({
		resize: function (event, ui) {
			__$__.editor.resize();
		}
	});
	__$__.__networkSelector = $('#resizableNetwork');
	__$__.__resetBottonSelector = $('#resetButton');
	__$__.__networkSelector.resizable({
		resize: function (event, ui) {
			let width = __$__.__networkSelector.css('width');
			let height = __$__.__networkSelector.css('height');
			__$__.network.setSize(width, height);
			__$__.network.redraw();
			__$__.__resetBottonSelector.css('left', width);
			__$__.__resetBottonSelector.css('top', height);
		}
	});
</script>

</body>
</html>
